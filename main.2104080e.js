parcelRequire=function(e,r,t,n){var i,o="function"==typeof parcelRequire&&parcelRequire,u="function"==typeof require&&require;function f(t,n){if(!r[t]){if(!e[t]){var i="function"==typeof parcelRequire&&parcelRequire;if(!n&&i)return i(t,!0);if(o)return o(t,!0);if(u&&"string"==typeof t)return u(t);var c=new Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[t][1][r]||r},p.cache={};var l=r[t]=new f.Module(t);e[t][0].call(l.exports,p,l,l.exports,this)}return r[t].exports;function p(e){return f(p.resolve(e))}}f.isParcelRequire=!0,f.Module=function(e){this.id=e,this.bundle=f,this.exports={}},f.modules=e,f.cache=r,f.parent=o,f.register=function(r,t){e[r]=[function(e,r){r.exports=t},{}]};for(var c=0;c<t.length;c++)try{f(t[c])}catch(e){i||(i=e)}if(t.length){var l=f(t[t.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):n&&(this[n]=l)}if(parcelRequire=f,i)throw i;return f}({"WEy1":[function(require,module,exports) {
"use strict";function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function i(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var n=function(){function t(i,n){e(this,t),this.value=Math.random()<.9?2:4,this.tileHTML=document.createElement("div"),this.position={row:i,cell:n,indexArr:4*i+n}}return i(t,[{key:"setNewPosition",value:function(e,t){this.position={row:e,cell:t,indexArr:4*e+t}}},{key:"merge",value:function(e){this.value+=e.value,e.setNewPosition(this.position.row,this.position.cell),this.tileHTML.style.zIndex="2",e.tileHTML.style.zIndex="1",e.render(),setTimeout(function(){return e.tileHTML.remove()},300)}},{key:"render",value:function(){var e=document.querySelectorAll(".field-cell");this.tileHTML.textContent="".concat(this.value),this.tileHTML.className="tile tile--".concat(this.value);var t=e[this.position.indexArr].getBoundingClientRect(),i=t.top,n=t.left;this.tileHTML.style.top="".concat(i,"px"),this.tileHTML.style.left="".concat(n,"px")}},{key:"addTileToView",value:function(){document.querySelector(".tile-container").append(this.tileHTML)}}]),t}();exports.default=n;
},{}],"yYWX":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var t=e(require("./Tile"));function e(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){for(var i=0;i<e.length;i++){var a=e[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}function n(t,e,i){return e&&a(t.prototype,e),i&&a(t,i),t}var r=function(){function e(){i(this,e),this.matrix=[[null,null,null,null],[null,null,null,null],[null,null,null,null],[null,null,null,null]],this.wasMove=!1,this.maxTileValue=2048,this.wasMerge=!1,this.mergedTilesSum=0,this.win=!1,this.addTile(),this.addTile(),this.updated()}return n(e,[{key:"coordsEmptyTiles",value:function(){return this.matrix.map(function(t,e){return t.map(function(t,i){if(null==t)return{x:e,y:i}})}).flat().filter(function(t){return t})}},{key:"addTile",value:function(){var e=this.coordsEmptyTiles(),i=e[Math.floor(Math.random()*e.length)],a=i.x,n=i.y;this.matrix[a][n]=new t.default(a,n),this.matrix[a][n].addTileToView()}},{key:"updated",value:function(){for(var t=0;t<this.matrix.length;t++)for(var e=0;e<this.matrix.length;e++)this.matrix[t][e]&&(this.matrix[t][e].setNewPosition(t,e),this.matrix[t][e].render())}},{key:"clear",value:function(){this.matrix.flat().filter(function(t){return t}).forEach(function(t){t.tileHTML.remove()})}},{key:"moveLeft",value:function(){this.cleanMoveMerge(),this.shift(!1)}},{key:"moveRight",value:function(){this.cleanMoveMerge(),this.shift()}},{key:"moveUp",value:function(){this.cleanMoveMerge(),this.shiftUpDown(!1)}},{key:"moveDown",value:function(){this.cleanMoveMerge(),this.shiftUpDown()}},{key:"swapTiles",value:function(t,e,i,a){var n=this.matrix[t][e];this.matrix[t][e]=this.matrix[i][a],this.matrix[i][a]=n,this.wasMove=!0}},{key:"shift",value:function(){for(var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=0;e<this.matrix.length;e++)for(var i=t?this.matrix.length-1:0,a=t?i-1:1,n=t?-1:1;a<this.matrix.length&&a>=0;)this.matrix[e][a]?this.matrix[e][i]?this.matrix[e][i].value===this.matrix[e][a].value?(this.matrix[e][i].setNewPosition(e,i),this.mergeTiles(e,a,e,i),i+=n,a+=n):(i+=n)===a&&(a+=n):(this.swapTiles(e,i,e,a),a+=n):a+=n}},{key:"shiftUpDown",value:function(){for(var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=0;e<this.matrix.length;e++)for(var i=t?this.matrix.length-1:0,a=t?i-1:1,n=t?-1:1;a<this.matrix.length&&a>=0;)this.matrix[a][e]?this.matrix[i][e]?this.matrix[i][e].value===this.matrix[a][e].value?(this.matrix[i][e].setNewPosition(i,e),this.mergeTiles(a,e,i,e),i+=n,a+=n):(i+=n)===a&&(a+=n):(this.swapTiles(i,e,a,e),a+=n):a+=n}},{key:"mergeTiles",value:function(t,e,i,a){this.wasMerge=!0;var n=this.matrix[t][e].value;this.mergedTilesSum+=2*n,this.matrix[i][a].merge(this.matrix[t][e]),this.matrix[t][e]=null,this.matrix[i][a].value===this.maxTileValue&&(this.win=!0)}},{key:"cleanMoveMerge",value:function(){this.wasMove=!1,this.wasMerge=!1}},{key:"isMergePossible",value:function(){return this.matrix.flat().some(function(t,e,i){var a=t.value;return(e+1)%4!=0&&a===i[e+1].value||e+4<=i.length-1&&a===i[e+4].value})}}]),e}();exports.default=r;
},{"./Tile":"WEy1"}],"w9FL":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=t(require("./Matrix"));function t(e){return e&&e.__esModule?e:{default:e}}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var s=0;s<t.length;s++){var i=t[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function r(e,t,s){return t&&i(e.prototype,t),s&&i(e,s),e}var n=function(){function t(){s(this,t),this.score=0,this.table=new e.default,this.listenerArrows=this.handleArrowsButtonPressing.bind(this),this.touchStartListener=this.handleTouchStart.bind(this),this.touchEndListener=this.handleTouchEnd.bind(this),this.gameField=document.querySelector(".game-field"),this.endGame=document.querySelector(".message-lose"),this.addScore=document.querySelector(".game-score"),this.winGame=document.querySelector(".message-win"),this.arrows=["ArrowLeft","ArrowUp","ArrowRight","ArrowDown"],document.addEventListener("keydown",this.listenerArrows),this.x1=null,this.y1=null,this.gameField.addEventListener("touchstart",this.touchStartListener),this.gameField.addEventListener("touchmove",this.touchEndListener)}return r(t,[{key:"handleTouchStart",value:function(e){e.preventDefault();var t=e.touches[0];this.x1=t.clientX,this.y1=t.clientY}},{key:"handleTouchEnd",value:function(e){if(e.preventDefault(),!this.x1||!this.y1)return!1;var t=e.touches[0].clientX,s=e.touches[0].clientY,i=t-this.x1,r=s-this.y1;Math.abs(i)>Math.abs(r)?i>0?this.table.moveRight():this.table.moveLeft():r>0?this.table.moveDown():this.table.moveUp(),this.x1=null,this.y1=null,this.allChecks()}},{key:"handleArrowsButtonPressing",value:function(e){if(this.arrows.includes(e.key)){switch(e.preventDefault(),e.key){case"ArrowLeft":this.table.moveLeft();break;case"ArrowUp":this.table.moveUp();break;case"ArrowRight":this.table.moveRight();break;case"ArrowDown":this.table.moveDown()}this.allChecks()}}},{key:"allChecks",value:function(){var e=this;(this.table.wasMove||this.table.wasMerge)&&this.table.addTile(),this.table.updated(),this.table.wasMerge&&(this.score+=this.table.mergedTilesSum,this.table.mergedTilesSum=0),this.addScore.textContent=this.score,this.table.coordsEmptyTiles().length<1&&!this.table.isMergePossible()?setTimeout(function(){return e.endGame.classList.remove("hidden")},1e3):this.table.win&&this.winGame.classList.remove("hidden")}},{key:"stop",value:function(){document.removeEventListener("keydown",this.listenerArrows),this.gameField.removeEventListener("touchstart",this.touchStartListener),this.gameField.removeEventListener("touchmove",this.touchEndListener),this.table.clear(),this.endGame.classList.add("hidden"),this.winGame.classList.add("hidden"),this.score=0,this.addScore.textContent="0"}}]),t}();exports.default=n;
},{"./Matrix":"yYWX"}],"KIzB":[function(require,module,exports) {
"use strict";var t=e(require("./Game"));function e(t){return t&&t.__esModule?t:{default:t}}var s,r=document.querySelector("button");r.addEventListener("click",function(e){var a=document.querySelector(".message-start");s&&s.stop(),a.classList.add("hidden"),s=new t.default,r.classList.remove("start"),r.classList.add("restart"),r.textContent="Restart"});
},{"./Game":"w9FL"}]},{},["KIzB"], null)
//# sourceMappingURL=main.2104080e.js.map